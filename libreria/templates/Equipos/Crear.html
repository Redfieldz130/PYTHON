{% extends "Paginas/Base.html" %}

{% block titulo %}Agregar nuevo Equipo{% endblock %}

{% block contenido %}
<div class="d-flex justify-content-center align-items-center vh-400">
    <div class="card shadow p-6" style="width: 900px;">
        <div class="card-header text-center">
            <h4>Agregar un nuevo equipo</h4>
        </div>
        <div class="card-body">

            {% if messages %}
                <div class="alert alert-info">
                    {% for message in messages %}
                        <p>{{ message }}</p>
                    {% endfor %}
                </div>
            {% endif %}

            <form method="post" enctype="multipart/form-data" id="equipoForm">
                {% csrf_token %}

                <div class="mb-3">
                    <label for="marca" class="form-label">Marca</label>
                    {{ formulario.marca }}
                </div>

                <div class="mb-3">
                    <label for="tipo" class="form-label">Tipo de Dispositivo</label>
                    {{ formulario.tipo }}
                </div>

                <div class="mb-3">
                    <label for="serial" class="form-label">Serial</label>
                    {{ formulario.serial }}
                </div>

                <div class="mb-3">
                    <label for="modelo" class="form-label">Modelo</label>
                    {{ formulario.modelo }}
                </div>

                <div class="mb-3">
                    <label for="observaciones" class="form-label">Observaciones</label>
                    {{ formulario.observaciones }}
                </div>

                <div class="mb-3">
                    <label for="mac_address" class="form-label">Dirección MAC</label>
                    <input type="text" name="mac_address" id="mac_address" class="form-control"
                           placeholder="Ingrese la dirección MAC" maxlength="12" required>
                </div>
                

                <div class="mb-3 text-center">
                    <button type="submit" class="btn btn-primary">Guardar</button>
                </div>
            </form>

        </div>
    </div>
</div>
{% endblock %}

{% block JS %}
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const macInput = document.getElementById('mac_address');
        const form = document.getElementById('equipoForm');
    
        macInput.addEventListener('input', function () {
            // Eliminar cualquier carácter no hexadecimal
            let val = macInput.value.replace(/[^a-fA-F0-9]/g, '').toUpperCase();
    
            // Limitar a 12 caracteres hexadecimales
            if (val.length > 12) val = val.slice(0, 12);
    
            // Asignar el valor formateado al campo de texto (sin los dos puntos aún)
            macInput.value = val;
        });
    
        form.addEventListener('submit', function (e) {
            const mac = macInput.value.trim();
            const macRegex = /^[0-9A-F]{12}$/; // Validar que sean solo 12 caracteres hexadecimales
    
            // Validar si el formato de la dirección MAC es correcto
            if (!macRegex.test(mac)) {
                e.preventDefault(); // Prevenir el envío del formulario si el formato es incorrecto
                Swal.fire({
                    icon: 'error',
                    title: 'Formato inválido',
                    text: 'La dirección MAC debe ser de 12 caracteres hexadecimales sin los dos puntos.',
                    confirmButtonText: 'OK'
                });
            }
        });
    });
    
    
</script>
{% endblock %}






