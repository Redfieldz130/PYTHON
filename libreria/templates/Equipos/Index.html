{% extends "Paginas/Base.html" %}

{% block titulo %}Aplicación de Inventario{% endblock %}

{% block contenido %}
<div class="d-flex justify-content-center">
    <div class="card border-10 shadow-lg rounded-4 bg-light">
        <div class="card-header text-center bg-primary text-white py-4">
            <h5 class="mb-0 font-weight-bold">Inventario de Equipos</h5>
        </div>

        <div class="card-body">
            <h4 class="card-title text-center text-primary mb-4">Lista de Equipos</h4>

            <!-- Input de Búsqueda -->
            <div class="mb-4">
                <input type="text" id="searchInput" class="form-control" placeholder="Buscar por Modelo, Marca o Serial" oninput="searchTable()">
            </div>

            <!-- Botones de navegación entre pestañas -->
            <ul class="nav nav-tabs" id="equiposTabs">
                <li class="nav-item">
                    <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#laptops">Laptops</button>
                </li>
                <li class="nav-item">
                    <button class="nav-link" data-bs-toggle="tab" data-bs-target="#celulares">Celulares</button>
                </li>
                <li class="nav-item">
                    <button class="nav-link" data-bs-toggle="tab" data-bs-target="#impresoras">Impresoras</button>
                </li>
                <li class="nav-item">
                    <button class="nav-link" data-bs-toggle="tab" data-bs-target="#monitores">Monitores</button>
                </li>
            </ul>

            <!-- Contenido de las pestañas -->
            <div class="tab-content mt-3">
                <!-- Laptops -->
                <div class="tab-pane fade show active" id="laptops">
                    {% include 'Equipos/partials/equipo_table.html' with equipos=equipos_laptop titulo="Laptops" %}
                </div>

                <!-- Celulares -->
                <div class="tab-pane fade" id="celulares">
                    {% include 'Equipos/partials/equipo_table.html' with equipos=equipos_celular titulo="Celulares" %}
                </div>

                <!-- Impresoras -->
                <div class="tab-pane fade" id="impresoras">
                    {% include 'Equipos/partials/equipo_table.html' with equipos=equipos_impresora titulo="Impresoras" %}
                </div>

                <!-- Monitores -->
                <div class="tab-pane fade" id="monitores">
                    {% include 'Equipos/partials/equipo_table.html' with equipos=equipos_monitor titulo="Monitores" %}
                </div>
            </div>

            <!-- Botón para imprimir -->
            <div class="text-center mt-3">
                <button id="printBtn" class="btn btn-secondary btn-sm rounded-pill text-uppercase">
                    <i class="fas fa-print"></i> Imprimir
                </button>
            </div>

             {% if perms.libreria.add_equipo %}
            
            <div class="text-center mt-4">
                <a href="{% url 'crear_equipo' %}" class="btn btn-primary btn-lg rounded-pill text-uppercase">
                    Añadir Nuevo Equipo
                </a>

            </div>
            {% endif %}
        </div>
    </div>
</div>

<script>
    document.getElementById("printBtn").addEventListener("click", function() {
        window.print();
    });

    function searchTable() {
        let input = document.getElementById("searchInput").value.toUpperCase();
        let tables = ['laptopsTable', 'celularesTable', 'impresorasTable', 'monitoresTable'];

        tables.forEach(function(tableId) {
            let table = document.getElementById(tableId);
            if (table) {
                let rows = table.querySelectorAll("tbody tr");

                rows.forEach(function(row) {
                    let text = row.innerText.toUpperCase();
                    row.style.display = text.includes(input) ? "" : "none";
                });
            }
        });
    }
</script>

{% endblock %}
